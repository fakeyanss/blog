---
title: docsify æŠ˜è…¾è®°
date: 2021-05-09 15:42:18
tags: docsify
---

docsifyï¼Œä¸“ä¸ºå–œæ¬¢æŠ˜è…¾çš„ä½ ã€‚

<!-- more -->

## ä½¿ç”¨ä½“éªŒ

äº”ä¸€å›å®¶åªå¸¦äº†å…¬å¸ç¬”è®°æœ¬ï¼Œæ²¡ä»€ä¹ˆå¨±ä¹è½¯ä»¶ï¼Œæ‰€ä»¥é—²æ—¶åˆ·äº†ä¸‹ Githubï¼Œå‘ç°ä¸€ä¸ª [TIL(things I learn)](https://github.com/Bhupesh-V/til) é¡¹ç›®æŒºå¥½çš„ï¼Œäºæ˜¯ clone ä¸‹æ¥åšäº†ä¸€ä¸ªè‡ªå·±çš„é¡¹ç›®ï¼Œè¿™æ˜¯[æˆ‘çš„ TIL](https://foreti.me/til/#/) è®°å½•ã€‚

TIL æœ¬æ„æ˜¯è®°å½•è‡ªå·±å­¦åˆ°çš„çŸ¥è¯†ç‚¹ã€‚å®é™…å·¥ä½œä¸­ä¼šç»å¸¸é‡åˆ°é—®é¢˜å¹¶è§£å†³é—®é¢˜ï¼Œé•¿æœŸä»¥æ¥å¹¶æ²¡æœ‰åˆ»æ„è®°å½•ï¼Œæœ‰äº›é—®é¢˜å•å‡­è®°å¿†ä¼šåœ¨ä¸€æ®µæ—¶é—´åå¿˜è®°ã€‚

åŸé¡¹ç›®ä¸­æ˜¯ä¾èµ– Gitbook åšçš„æ–‡æœ¬æ¸²æŸ“ï¼ŒæŒ‰ç…§æˆ‘å‡ å¹´å‰çš„ä½¿ç”¨ç»å†æ¥çœ‹ï¼ŒGitbookä¸ç®—å¥½ç”¨ï¼Œå¹¶ä¸”åœ¨å›½å†…è®¿é—®é€Ÿåº¦å ªå¿§ï¼Œæ‰€ä»¥æˆ‘åœ¨è¿™é‡Œé€‰æ‹©äº† [docsify](https://docsify.js.org/#/)ã€‚

docsify æ˜¯ä¸€ä¸ªç±»ä¼¼ Gitbook å°† Markdown æ–‡ä»¶é€‰æŸ“æˆ HTML é¡µé¢çš„å·¥å…·ã€‚å½“ç„¶ä¹Ÿæœ‰ä¸€å®šå·®åˆ«ï¼ŒGitbook æ˜¯æå‰ç¼–è¯‘æˆ HTML é™æ€é¡µé¢ï¼Œè€Œ docsify æ˜¯è¯·æ±‚æ—¶æ¸²æŸ“ã€‚åœ¨ä½¿ç”¨ä¸Šæ¥çœ‹ï¼Œdocsify çš„é€Ÿåº¦æ›´å¿«ï¼Œä¹Ÿæ›´ç®€å•ä¸€äº›ï¼Œå¯è‡ªå®šä¹‰çš„é…ç½®éå¸¸å¤šï¼Œé€‚ç”¨äºå–œæ¬¢è‡ªå·±åŠ¨æ‰‹çš„å¼€å‘è€…ã€‚
docsify åŠŸèƒ½éå¸¸ä¸°å¯Œï¼Œä¸è¿‡åŸºæœ¬ç•Œé¢æ ·å¼æ¯”è¾ƒç®€å•ã€‚

å€¼å¾—åæ§½çš„æ˜¯å³ä¸Šè§’repoè§’æ ‡å¤ªå¤§äº†ï¼Œå’Œnavbarèœå•å¹¶åœ¨ä¸€èµ·å¤ªä¸‘é™‹äº†ã€‚

![image-20210509161029217](https://cdn.jsdelivr.net/gh/fakeyanss/imgplace@master/2021/2021-05-09_image-20210509161029217-05ff56.png)

å…¶ä»–çš„ä¸€äº›æ’ä»¶ï¼Œæ¯”å¦‚ ã€Œedit on githubã€ ä¸ ã€Œå­—æ•°æ’ä»¶ã€ ä¼šå°†æ­£æ–‡å†…å®¹å¾€ä¸‹æŒ¤ï¼Œä¹Ÿå¾ˆåˆ«æ‰­ã€‚

![image-20210509161238605](https://cdn.jsdelivr.net/gh/fakeyanss/imgplace@master/2021/2021-05-09_image-20210509161238605-8f3c7c.png)

å®˜æ–¹æ–‡æ¡£é‡Œæ²¡æœ‰æµ…è‰²æ¨¡å¼ä¸æ·±è‰²æ¨¡å¼çš„çµæ´»é€‚é…ï¼Œåªå•ä¸€æ”¯æŒäº†æµ…è‰²æˆ–æ·±è‰²ä¸»é¢˜ï¼Œä¹Ÿå°±æ˜¯è¯´åªèƒ½é€‰æ‹©ä¸€ç§ã€‚

å¦‚æœæƒ³åŒæ—¶æ”¯æŒæµ…è‰²å’Œæ·±è‰²ï¼Œç›®å‰æœ‰ä¸¤ä¸ªæ–¹æ³•ï¼š

1. æœ‰ä¸€ä¸ªç¬¬ä¸‰æ–¹ä¸»é¢˜æ’ä»¶ï¼Œ[docsify darklight theme](https://docsify-darklight-theme.boopathikumar.me/#/)ï¼Œå®‰è£…å³ç”¨ï¼Œæä¾›ä¸€ä¸ªæŒ‰é’®æ‰‹åŠ¨åˆ‡æ¢ï¼Œä¸è¿‡é—®é¢˜æ˜¯ä»ç„¶æ˜¯æŒ‰é’®å°†æ­£æ–‡å†…å®¹å¾€ä¸‹æŒ¤å‹ã€‚æˆ‘æ·»åŠ äº†ä¸€æ®µJSæ–¹æ³•ï¼Œå¼ºåˆ¶å°†æŒ‰é’®ç§»åˆ°å·¦ä¾§sidebarã€‚
2. è‡ªå®šä¹‰cssï¼Œæ”¯æŒè·Ÿéšç³»ç»Ÿæ·±è‰²æ¨¡å¼ï¼Œè‡ªåŠ¨åˆ‡æ¢ã€‚å®ç°æ–¹å¼ç±»ä¼¼æˆ‘çš„blogï¼Œç›®å‰è¿˜æ²¡æœ‰æ—¶é—´å¼€å‘ã€‚

## å¼€å§‹æ„å»º

é¦–å…ˆéœ€è¦æœ¬åœ°å…·å¤‡ node å’Œ npm ç¯å¢ƒï¼Œé€‰æ‹©æœ€æ–°çš„ç¨³å®šç‰ˆæœ¬å³å¯ã€‚

å®‰è£… docsify-cliï¼š

```bash
npm install -g docsify-cli
```

åˆ›å»º Git ä»“åº“ï¼Œå¹¶ä¸”åˆå§‹åŒ– docsifyï¼š

```bash
mkdir docsify-demo && cd docsify-demo
docsify init docs
```

è¿™ä¹‹åä¼šè‡ªåŠ¨åˆ›å»ºå‡º docs ç›®å½•ï¼Œå…¶ä¸­ä¼šæœ‰ä¸€ä¸ª `index.html` æ–‡ä»¶ã€‚

å¯ä»¥æœ¬åœ°é¢„è§ˆäº†ï¼š

```bash
docsify serve docs
```

ç„¶åï¼Œå¯ä»¥ç¼–è¾‘ `index.html`ï¼š

```html
window.$docsify = {
	name: 'Things I Learn',
	loadSidebar: true,
	loadNavbar: true,
	search: 'auto',
	// ä¸‹é¢æŒ‰ç…§æ–‡æ¡£æ·»åŠ å„ç§æ’ä»¶å³å¯
	...
}
```

å¯ä»¥åœ¨ docs ç›®å½•ä¸‹åˆ›å»ºè¿™äº›æ–‡ä»¶ï¼š

- ä¸€ä¸ªç©ºçš„ `.nojekyll` æ–‡ä»¶ï¼Œç”¨äºé˜»æ­¢ Github Page å¿½ç•¥ä¸‹åˆ’çº¿å¼€å¤´çš„æ–‡ä»¶ï¼›
- `_sidebar.md` æ–‡ä»¶ï¼Œè‡ªå®šä¹‰å·¦ä¾§è¾¹æ ç›®å½•ï¼›
- `_navbar.md` æ–‡ä»¶ï¼Œè‡ªå®šä¹‰å³ä¸Šè§’èœå•æ ã€‚

å¯ä»¥å®‰è£… [docsify-tool](https://www.npmjs.com/package/docsify-tools) ä¾èµ–ï¼Œæˆ‘åªç”¨å®ƒæ¥è‡ªåŠ¨ç”Ÿæˆ `_sidebar.md` å†…å®¹ï¼š

```bash
npm i -g docsify-tools
docsify-auto-sidebar -d docs
```

`docsify-auto-sidebar` ä¼šå°†æŒ‡å®š docs ç›®å½•ä¸‹æ‰€æœ‰ Markdown æ–‡ä»¶è¯†åˆ«ä¸ºç›®å½•å†…å®¹ï¼Œæ‰€ä»¥ä¼šå°† `_navbar.md` ä¹Ÿå°†åˆ°ç›®å½•é‡Œï¼Œæˆ‘å†™äº†ä¸€ä¸ª Git pre-commit hook æ¥é˜»æ­¢è¿™ä¸ªåŠ¨ä½œã€‚

åœ¨é¡¹ç›®æ ¹ç›®å½•ï¼Œ`vim .git/hooks/pre-commit`ï¼Œå¡«å…¥ï¼š

```bash
docsify-auto-sidebar -d docs
# æ›¿æ¢ï¼ŒäºŒé€‰ä¸€
sed -i "" "/_navbar/d" docs/_sidebar.md # mac
sed -i "/_navbar/d" docs/_sidebar.md # linux
git add .
```

## è¯„è®ºç³»ç»Ÿ

docsify æ”¯æŒ Disqus å’Œ [Gitalk](https://github.com/gitalk/gitalk) ä¸¤ç§è¯„è®ºç³»ç»Ÿã€‚Disqus åœ¨å›½å†…ä¸å¤ªå¥½ç”¨ï¼Œæ‰€ä»¥æˆ‘é€‰æ‹©è¯•è¯• Gitalkã€‚

æŒ‰ç…§ docsify çš„æ–‡æ¡£ï¼Œå¾ˆç®€å•çš„ä½¿ç”¨ä¸Šäº† Gitalk è¯„è®ºï¼Œä½†æ˜¯åœ¨ä½¿ç”¨ä¸­å‘ç°æ»¡æ»¡çš„éƒ½æ˜¯å‘ã€‚

æˆ‘è¿™é‡Œä¸»è¦é—®é¢˜æ˜¯æŸäº›æ–‡ç« åŠ è½½è¯„è®ºæ—¶æŠ¥é”™ `Error: Validation Failed`ã€‚

Gitalk ä¾æ‰˜äº Github issue å­˜åœ¨ï¼Œå¹¶ä¸”ä½¿ç”¨ issue label å’Œæ–‡ç« ä¸€ä¸€å…³è”ï¼Œissue label æœ‰ä¸ªé™åˆ¶æ˜¯å­—ç¬¦ä¸²é•¿åº¦éœ€ä¸è¶…è¿‡ 50ã€‚

ç„¶è€Œ docsify é»˜è®¤å’Œ Gitalk çš„é›†æˆï¼Œåˆ›å»º issue æ—¶ä½¿ç”¨çš„ label æ˜¯å½“å‰é¡µé¢çš„ `location.href`ï¼Œä¹Ÿå³æ˜¯ URL å…¨æ–‡ï¼Œè¿™ä¹Ÿå¤ªå®¹æ˜“è¶…è¿‡ 50 äº†å§ğŸ¥²ã€‚

åœ¨ Gitalk æ–‡æ¡£ä¸­ï¼Œä¹Ÿæœ‰è¯´æ˜ id å±æ€§ï¼Œé»˜è®¤ä½¿ç”¨ `location.href`ï¼š

>**id** `String`
>
>Default: `location.href`.
>
>é¡µé¢çš„å”¯ä¸€æ ‡è¯†ã€‚é•¿åº¦å¿…é¡»å°äº50ã€‚

åœ¨ç½‘ä¸Šæ‰¾åˆ°çš„è§£å†³æ–¹æ¡ˆï¼Œæ˜¯æ‰‹åŠ¨è®¾ç½® id å±æ€§ï¼Œå¯¹ href åšä¸€æ¬¡ md5ï¼Œå›ºå®šåˆ° 32 ä½ã€‚çœ‹èµ·æ¥å¾ˆä¸é”™ï¼Œå¼•ç”¨äº†ä¸€ä¸ª md5 åº“ä¹‹åï¼Œå¾ˆç®€å•æå®šäº†ã€‚ç„¶è€Œå®é™…åº”ç”¨å‘ç° docsify åˆ‡æ¢é¡µé¢æ—¶ï¼Œè·¯ç”±ç»å¸¸æ²¡æœ‰è‡ªåŠ¨åˆ·æ–°ï¼Œå¯¼è‡´å„ç§å¥‡å¥‡æ€ªæ€ªçš„gitalkåˆå§‹åŒ–é—®é¢˜ï¼Œç„¶ååˆ›å»ºå‡ºçš„ issue çƒ‚ä¸ƒå…«ç³Ÿï¼Œè€Œä¸”ç»å¸¸åœ¨ A é¡µé¢å†™çš„è¯„è®ºåœ¨ B é¡µé¢å¯ä»¥åŠ è½½å‡ºæ¥ã€‚æˆ‘çŒœæµ‹è¿˜æ˜¯è·¯ç”±å›è°ƒçš„é—®é¢˜ï¼Œä½†æˆ‘çœ‹ä¸æ‡‚æºç ï¼Œæ²¡æ³•è§£å†³ã€‚

ç„¶ååœ¨ Github æ‰¾äº†ä¸€äº›ä½¿ç”¨ docsify å†™çš„é¡¹ç›®æ–‡æ¡£ï¼Œå‘ç°ä¸€ä¸ª [l-hammer/You-need-to-know-css](https://github.com/l-hammer/You-need-to-know-css)ï¼Œæ•ˆæœå¾ˆå¥½å¹¶ä¸”è¯„è®ºæ²¡æœ‰é—®é¢˜ã€‚

è¯»äº†è¿™ä¸ªé¡¹ç›®çš„å®ç°ï¼Œå‘ç°æ²¡æœ‰ä¾èµ– docsify å¯¹ Gitalk çš„é›†æˆï¼Œç›´æ¥å¼•å…¥çš„ Gitalk ä¾èµ–ï¼Œå¹¶ä¸”åœ¨è·¯ç”±å›è°ƒä¸­åˆå§‹åŒ– gitalk å®ä¾‹ã€‚

å¤§æ¦‚å®ç°å¦‚ä¸‹ï¼š

```js
gitalkConfig = {
    clientID: "xxx", // your github oauth app client id
    clientSecret: "xxx", //your github oauth app client screct key
    repo: "til", //your github repo name
    owner: "fakeYanss", //your github user name
    admin: ["fakeYanss"], //your gitalk administrators
    perPage: 20,
    language: "en",
    labels: ["Gitalk"],
    distractionFreeMode: false
};
plugins: [
    function (hook, vm) {
        hook.doneEach(function () {
            var label, domObj, main, divEle, gitalk;
            label = vm.route.path.split("/").pop();
            domObj = Docsify.dom;
            main = domObj.getNode("#main");

            /**
             * render gittalk
             */
            if (vm.route.path.includes("zh-cn")) {
                gitalkConfig.language = "zh-CN";
            }
            Array.apply(
                null,
                document.querySelectorAll("div.gitalk-container")
            ).forEach(function (ele) {
                ele.remove();
            });
            divEle = domObj.create("div");
            divEle.id = "gitalk-container-" + label;
            divEle.className = "gitalk-container";
            divEle.style = "width: " + main.clientWidth + "px; margin: 0 auto 20px;";
            domObj.appendTo(domObj.find(".content"), divEle);
            gitalk = new Gitalk(
                Object.assign(gitalkConfig, {
                    id: !label ? "home" : label
                })
            );
            gitalk.render("gitalk-container-" + label);
        })
    }
]
```

æœ€åæ•ˆæœæ˜¯è¿™æ ·ï¼Œlabel ä½¿ç”¨çš„æ˜¯ location.hash çš„å°¾éƒ¨æŒ‰ `/` åˆ†å‰²åçš„æœ€åä¸€æ®µå†…å®¹ï¼Œå…¶å®å°±æ˜¯æ¯ä¸ª Markdown æ–‡ä»¶åï¼Œåˆ°è¿™ä¸€æ­¥å·²ç»å¾ˆå®¹æ˜“æ§åˆ¶ä¸è¶…è¿‡ 50 ä½é•¿åº¦äº†ã€‚

![image-20210509172714680](https://cdn.jsdelivr.net/gh/fakeyanss/imgplace@master/2021/2021-05-09_image-20210509172714680-b9cba4.png)



## ä¸»é¢˜å®šåˆ¶

### darklight

ä½¿ç”¨docsify darklight themeï¼ŒæŒ‰ç…§æ–‡æ¡£è¯´æ˜ï¼Œéå¸¸ç®€å•ã€‚

åœ¨ `index.html` å¤´éƒ¨æ·»åŠ ï¼š

```html
<link 
    rel="stylesheet"
    href="//cdn.jsdelivr.net/npm/docsify-darklight-theme@latest/dist/style.min.css"
    title="docsify-darklight-theme"
    type="text/css"
/>
```

åœ¨åº•éƒ¨æ·»åŠ ï¼š

```html
<script 
    src="//cdn.jsdelivr.net/npm/docsify-darklight-theme@latest/dist/index.min.js"
    type="text/javascript">
</script>
```

å¦‚æœå¯¹é»˜è®¤çš„æŒ‰é’®å±•ç¤ºä½ç½®æ»¡æ„ï¼Œé‚£å¯ä»¥åˆ°æ­¤ç»“æŸäº†ï¼Œä¸‹é¢æ˜¯æˆ‘çš„æ”¹åŠ¨ï¼Œå°†æŒ‰é’®ç§»åŠ¨åˆ°å·¦ä¾§è¾¹æ ï¼š

![image-20210509163856711](https://cdn.jsdelivr.net/gh/fakeyanss/imgplace@master/2021/2021-05-09_image-20210509163856711-ff5c45.png)

ä¸‹è½½ [darklight çš„ Javascript æºç ](https://cdn.jsdelivr.net/npm/docsify-darklight-theme@latest/dist/index.min.js)ï¼Œæ”¾åˆ°é¡¹ç›®é‡Œï¼Œå¯ä»¥å‘½åä¸º `theme.js`ï¼Œç§»é™¤è¿œç¨‹å¼•ç”¨ï¼Œæ·»åŠ æœ¬åœ°å¼•ç”¨ï¼š

```html
<script src="theme.js"></script>
```

ç„¶åä¿®æ”¹ `theme.js` çš„ä¸€å¤„æ–¹æ³•ï¼Œè¿™é‡Œçš„ `afterEach` æ˜¯ docsify è·¯ç”±å˜åŒ–å®Œæˆåçš„å›è°ƒå‡½æ•°ï¼Œä¸»é¢˜åŸç”Ÿçš„å†™æ³•å°±æ˜¯åœ¨ `e` å‰é¢ç®€å•æ·»åŠ ä¸€ä¸ª div å—ï¼Œè¿™ä¹Ÿæ˜¯æŒ‰é’®å°†æ­£æ–‡å†…å®¹å‘ä¸‹æŒ¤å‹çš„åŸå› ã€‚æ·»åŠ  else åˆ†æ”¯æ˜¯å› ä¸ºè¿™å—ä»£ç åœ¨æ¯æ¬¡è·¯ç”±å˜åŒ–åéƒ½ä¼šæ‰§è¡Œï¼Œæˆ‘ä»¬éœ€è¦è®©å®ƒåªåœ¨ç¬¬ä¸€æ¬¡åŠ è½½é¡µé¢æ—¶åˆ›å»ºæŒ‰é’® divã€‚

```js
e.afterEach((function (e, o) {
    if (document.getElementById('docsify-darklight-theme') == null) {
        o(e = '<div id="docsify-darklight-theme"><p>.</p></div>' + e)
    } else {
        o(e)
    }
}))
```

æºç æ˜¯ç¼–è¯‘è¿‡çš„ï¼Œä¸ºäº†é¿å…æ‰¾ä¸åˆ°åœ¨å“ªï¼Œè¿™é‡Œæ˜¯æˆ‘æ”¹è¿‡çš„ [theme.js](https://raw.githubusercontent.com/fakeYanss/til/master/docs/dist/theme.js) ä¸‹è½½åœ°å€ã€‚

ç”±äºæ²¡æœ‰æ·±å…¥é˜…è¯» docsify çš„ä¸»è¦æºç ï¼Œä¸ç¡®å®šè¿™å¤„æ–¹æ³•æ€ä¹ˆç›´æ¥æ”¹åŠ¨ï¼Œæ‰€ä»¥åœ¨å¤–é¢å¦å¤–å†™äº†ä¸€å¤„è„šæœ¬ä½œä¸ºåç½®å¤„ç†ï¼Œå°†æŒ‰é’® append åˆ°ä¾§è¾¹æ çš„ DOM ä¸‹ã€‚åœ¨ `index.html` ä¸­ï¼Œæ·»åŠ ä¸€æ®µ scriptï¼š

```html
<script>
    function move() {
      document.getElementsByClassName('sidebar')[0].setAttribute('id', 'sidebar-full')
      document.getElementById('sidebar-full').appendChild(document.getElementById('docsify-darklight-theme'))
      var button = document.getElementById('docsify-darklight-theme')
      button.style.position = 'fixed'
      button.style.left = '10px'
      button.style.bottom = '58px'
      button.style.top = 'auto'
      button.style.width = '18px'
      button.style.height = '18px'
    }
    var refreshId = setInterval(function () {
      if (null != document.getElementById('docsify-darklight-theme')) {
        move();
        clearInterval(refreshId);
      }
    }, 100);
</script>
```



å¦‚æœè§‰å¾—ä¾§è¾¹æ é—®é¢˜å¤ªæŒ¤ï¼Œå¯ä»¥å†è°ƒæ•´ä¸‹æ ·å¼ï¼š

```css
<style>
.sidebar-nav ul li {
    margin-left: 25px;
}

.sidebar-nav {
    line-height: 1.5em !important;
    padding-bottom: 76px;
}
</style>
```

### prefers-color-scheme

`prefers-color-scheme` æ˜¯ CSS media feature å¯¹é»‘æš—æ¨¡å¼çš„æ”¯æŒï¼Œ[è¯¦ç»†æ–‡æ¡£åœ¨æ­¤](https://developer.mozilla.org/en-US/docs/Web/CSS/@media/prefers-color-scheme)ã€‚

æŒ‰ç…§[æˆ‘çš„åšå®¢](https://foreti.me/blog/)çš„åšæ³•ï¼Œåªéœ€è®¾è®¡ä¸‹é»‘æš—æ¨¡å¼çš„èƒŒæ™¯é¢œè‰²ã€å­—ä½“é¢œè‰²ã€ä»£ç å—é¢œè‰²ã€è¶…é“¾æ¥é¢œè‰²ï¼ŒåŸºæœ¬æ•ˆæœå°±æœ‰äº†ã€‚

ç»†èŠ‚å¾…å¼€å‘...

---

